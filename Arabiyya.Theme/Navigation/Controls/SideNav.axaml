<UserControl
  x:Class="Arabiyya.Theme.Navigation.Controls.SideNav"
  xmlns="https://github.com/avaloniaui"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:avaglass="using:AvaGlass.Controls"
  xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
  xmlns:nav="using:Arabiyya.Theme.Navigation.Models"
  d:DesignHeight="450"
  d:DesignWidth="220"
  x:CompileBindings="False"
  mc:Ignorable="d">

  <UserControl.Resources>
    <DataTemplate x:Key="NavItemTemplate" DataType="nav:NavigationItem">
      <Grid Height="40" ToolTip.Tip="{Binding Label}">
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="Auto" />
          <ColumnDefinition Width="*" />
          <ColumnDefinition Width="Auto" />
        </Grid.ColumnDefinitions>

        <!--  Icon  -->
        <TextBlock
          Grid.Column="0"
          Width="20"
          Margin="12,0,8,0"
          HorizontalAlignment="Center"
          VerticalAlignment="Center"
          FontFamily="{StaticResource PhosphorFontFamily}"
          Text="{Binding Icon}" />

        <!--  Label  -->
        <TextBlock
          Grid.Column="1"
          VerticalAlignment="Center"
          Text="{Binding Label}"
          TextTrimming="CharacterEllipsis" />

        <!--  Badge  -->
        <Border
          Grid.Column="2"
          Margin="4,0,12,0"
          Padding="4,1"
          HorizontalAlignment="Right"
          VerticalAlignment="Center"
          Background="{DynamicResource Brush.Primary}"
          CornerRadius="10"
          IsVisible="{Binding ShowBadge}">
          <TextBlock
            FontSize="10"
            Foreground="{DynamicResource Brush.Text.OnPrimary}"
            Text="{Binding BadgeText}" />
        </Border>
      </Grid>
    </DataTemplate>
  </UserControl.Resources>

  <Grid>
    <!--  Use glass/acrylic panel depending on theme settings  -->
    <avaglass:GlassmorphicPanel x:Name="GlassPanel" Classes="GlassPanel">
      <Grid RowDefinitions="Auto,*,Auto">

        <!--  Header  -->
        <Border
          Grid.Row="0"
          Padding="16"
          BorderBrush="#20FFFFFF"
          BorderThickness="0,0,0,1"
          IsVisible="{Binding !!HeaderContent}">

          <!--  Header title  -->
          <Grid ColumnDefinitions="*,Auto">
            <TextBlock
              Margin="0,0,0,0"
              Classes="h4"
              IsVisible="{Binding !!Title}"
              Text="{Binding Title}" />

            <!--  Collapse Button  -->
            <Button
              Grid.Column="1"
              Width="30"
              Height="30"
              VerticalAlignment="Center"
              Classes="Icon"
              Command="{Binding ToggleExpandedCommand}"
              IsVisible="{Binding AllowCollapse}">
              <TextBlock FontFamily="{StaticResource PhosphorFontFamily}" Text="{Binding IsExpanded, Converter={StaticResource ExpandIconConverter}}" />
            </Button>

            <!--  Custom Header Content  -->
            <ContentControl
              Grid.Column="0"
              Grid.ColumnSpan="2"
              Content="{Binding HeaderContent}"
              IsVisible="{Binding !!HeaderContent}" />
          </Grid>
        </Border>

        <!--  Navigation Items  -->
        <ListBox
          Grid.Row="1"
          Margin="0,8"
          Padding="8,0"
          Background="Transparent"
          BorderThickness="0"
          ItemTemplate="{StaticResource NavItemTemplate}"
          ItemsSource="{Binding Items}"
          SelectedItem="{Binding SelectedItem}"
          SelectionMode="Single">
          <ListBox.Styles>
            <Style Selector="ListBoxItem">
              <Setter Property="Padding" Value="0" />
              <Setter Property="Margin" Value="0,2" />
              <Setter Property="CornerRadius" Value="4" />
              <Setter Property="IsEnabled" Value="{Binding IsEnabled}" />
            </Style>
            <Style Selector="ListBoxItem:selected /template/ ContentPresenter">
              <Setter Property="Background" Value="{DynamicResource Brush.Primary}" />
            </Style>
            <Style Selector="ListBoxItem:selected TextBlock">
              <Setter Property="Foreground" Value="{DynamicResource Brush.Text.OnPrimary}" />
            </Style>
            <Style Selector="ListBoxItem:disabled TextBlock">
              <Setter Property="Foreground" Value="{DynamicResource Brush.Text.Disabled}" />
            </Style>
          </ListBox.Styles>
        </ListBox>

        <!--  Footer  -->
        <Border
          Grid.Row="2"
          Padding="16"
          BorderBrush="#20FFFFFF"
          BorderThickness="0,1,0,0"
          IsVisible="{Binding !!FooterContent}">
          <ContentControl Content="{Binding FooterContent}" />
        </Border>
      </Grid>
    </avaglass:GlassmorphicPanel>
  </Grid>
</UserControl>